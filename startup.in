#!/bin/sh

# Copyright Â© 2017 Jakub Wilk <jwilk@jwilk.net>
# SPDX-License-Identifier: MIT

set -e -u

@@

export LC_ALL=C.UTF-8
export DEBIAN_FRONTEND=noninteractive
cat > /etc/apt/apt.conf.d/99local <<EOF
APT::Install-Recommends "false";
Apt::Get::Purge "true";
Apt::Get::Show-Versions "true";
Acquire::Languages "none";
EOF
apt-get update
apt-get dist-upgrade -y
apt-get install -y locales-all mosh
adduser --disabled-password --gecos "$gecos" "$user"
su "$user" -c 'mkdir -m 700 ~/.ssh'
cat .ssh/authorized_keys | su "$user" -c 'cat > ~/.ssh/authorized_keys'
